<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Hebrew Wordplay & Motifs | Book of Ruth</title>
  <meta name="description" content="Hebrew wordplay and motifs in Ruth including the Abraham parallel, á¸¥esed, shuv, kanaph, go'el, name reversals, and matched titles that shape the book's meaning.">

  <!-- Preload Critical Resources -->
  <link rel="preload" href="/assets/css/global-v2.css" as="style">
  <link rel="preload" href="https://projectcontext.org/assets/fonts/SBL_Hebrew.woff2" as="font" type="font/woff2" crossorigin>

  <!-- Stylesheets -->
  <link rel="stylesheet" href="/assets/css/global-v2.css">

  <!-- Page-specific styles with gradients and safe UX enhancements -->
  <style>
    /* Ensure content visibility - LIMITED ANIMATIONS */
    * {
      animation: none !important;
      transition: opacity 0.2s ease, background-color 0.2s ease, border-color 0.2s ease !important;
    }

    /* Force visibility on all cards */
    .theology-card,
    .word-pattern-card {
      opacity: 1 !important;
      visibility: visible !important;
      transform: none !important;
    }

    /* Hebrew Word Display */
    .hebrew-word {
      font-family: 'SBL Hebrew', 'Ezra SIL', serif;
      font-size: 2rem;
      color: #7209b7;
      direction: rtl;
      unicode-bidi: embed;
      display: block;
      margin-bottom: 0.25rem;
    }

    .transliteration {
      font-style: italic;
      color: #6b7280;
      font-size: 0.95rem;
      display: block;
    }

    .translation {
      font-size: 1.2rem;
      color: #6b7280;
    }

    /* Word Chips with Gradients and Tooltips */
    .word-chips-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 1rem;
      margin: 2rem 0;
    }

    .word-chip-link {
      text-decoration: none;
      color: inherit;
    }

    .word-chip {
      display: inline-block;
      position: relative;
      background: white;
      border: 2px solid #7209b7;
      border-radius: 30px;
      padding: 1rem 1.5rem;
      cursor: pointer;
      text-align: center;
    }

    .word-chip:hover {
      background: linear-gradient(135deg, #faf5ff 0%, #f0f4ff 100%);
      box-shadow: 0 8px 25px rgba(114, 9, 183, 0.25);
    }

    /* Simple tooltip */
    .word-chip .tooltip {
      position: absolute;
      bottom: 100%;
      left: 50%;
      transform: translateX(-50%);
      background: #333;
      color: white;
      padding: 0.5rem 1rem;
      border-radius: 6px;
      font-size: 0.85rem;
      white-space: nowrap;
      opacity: 0;
      pointer-events: none;
      margin-bottom: 0.5rem;
    }

    .word-chip:hover .tooltip {
      opacity: 1;
    }

    /* Hebrew Comparison Box with Gradient */
    .hebrew-comparison {
      background: linear-gradient(135deg, #fef3f2 0%, #faf5ff 100%);
      border: 2px solid #7209b7;
      border-radius: 16px;
      padding: 2rem;
      margin: 2rem 0;
    }

    .hebrew-comparison h4 {
      color: #7209b7;
      text-align: center;
      margin-bottom: 1.5rem;
      font-size: 1.3rem;
    }

    .comparison-row {
      display: grid;
      grid-template-columns: 1fr auto 1fr;
      gap: 1.5rem;
      align-items: center;
      margin: 1.5rem 0;
    }

    .comparison-item {
      background: white;
      padding: 1.5rem;
      border-radius: 12px;
      text-align: center;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .comparison-arrow {
      font-size: 2rem;
      color: #7209b7;
      text-align: center;
    }

    .hebrew-text {
      font-family: 'SBL Hebrew', 'Ezra SIL', serif;
      font-size: 1.8rem;
      color: #7209b7;
      direction: rtl;
      unicode-bidi: embed;
      display: block;
      margin: 0.5rem 0;
      line-height: 1.8;
    }

    .hebrew-highlight {
      background: linear-gradient(135deg, rgba(225, 29, 72, 0.2), rgba(114, 9, 183, 0.2));
      padding: 2px 6px;
      border-radius: 4px;
      border-bottom: 2px solid #7209b7;
    }

    /* Hebrew Display Box */
    .hebrew-display {
      text-align: center;
      padding: 2rem;
      background: white;
      border-radius: 12px;
      margin: 1.5rem 0;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }

    .hebrew-main {
      font-family: 'SBL Hebrew', 'Ezra SIL', serif;
      font-size: 3rem;
      color: #7209b7;
      margin-bottom: 1rem;
      direction: rtl;
      unicode-bidi: embed;
    }

    /* Word Pattern Cards with Gradients */
    .word-pattern-card {
      background: linear-gradient(135deg, #faf5ff 0%, #f0f4ff 100%);
      border: 2px solid #7209b7;
      border-radius: 16px;
      padding: 2rem;
      margin: 2rem 0;
      position: relative;
      overflow: hidden;
    }
    
    .word-pattern-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, #7209b7 0%, #e11d48 100%);
    }

    /* Enhanced Badges with Gradients */
    .enhancement-indicator {
      display: inline-block;
      background: linear-gradient(135deg, #10b981 0%, #059669 100%);
      color: white;
      padding: 0.25rem 0.75rem;
      border-radius: 20px;
      font-size: 0.75rem;
      font-weight: 600;
      margin-left: 0.75rem;
      vertical-align: middle;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .critical-badge {
      display: inline-block;
      background: linear-gradient(135deg, #e11d48 0%, #be123c 100%);
      color: white;
      padding: 0.25rem 0.75rem;
      border-radius: 20px;
      font-size: 0.75rem;
      font-weight: 600;
      margin-left: 0.75rem;
      vertical-align: middle;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    /* Key Insight Box */
    .key-insight {
      background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
      border-left: 4px solid #3b82f6;
      padding: 1rem 1.25rem;
      border-radius: 8px;
      margin: 1.5rem 0;
    }

    .key-insight strong {
      color: #1e40af;
    }

    /* Significance Box */
    .significance {
      background: linear-gradient(135deg, #f0f4ff 0%, #e8eeff 100%);
      border-radius: 12px;
      padding: 1rem 1.25rem;
      margin-top: 1.5rem;
      border-left: 4px solid #10b981;
    }

    .significance h4 {
      margin: .2rem 0 .75rem;
      color: #10b981;
      font-size: 1.1rem;
    }

    /* CTA Grid with Gradient Buttons - INCLUDING MISSING STUDY KIT */
    .cta-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin: 30px 0;
    }
    
    .cta-button {
      display: block;
      padding: 15px 20px;
      background: linear-gradient(135deg, #7209b7, #e11d48);
      color: white;
      text-align: center;
      border-radius: 12px;
      text-decoration: none;
      font-weight: 600;
    }
    
    .cta-button:hover {
      box-shadow: 0 10px 20px rgba(114, 9, 183, 0.3);
      color: white;
      opacity: 0.9;
    }

    /* Timeline with Gradient */
    .timeline {
      position: relative;
      padding-left: 2rem;
      margin: 1.5rem 0;
    }

    .timeline::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 3px;
      background: linear-gradient(180deg, #7209b7 0%, #e11d48 100%);
      border-radius: 2px;
    }

    .timeline-item {
      position: relative;
      padding: 1rem 1rem 1rem 1.5rem;
      margin-bottom: 1rem;
      opacity: 1;
      border-left: 3px solid transparent;
      background: rgba(248, 250, 252, 0.5);
      border-radius: 0 8px 8px 0;
    }

    .timeline-item:hover {
      background: white;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      border-left-color: #d4af37;
    }

    /* Chiastic Pattern */
    .chiastic-word-pattern {
      background: #f8fafc;
      border: 2px dashed #7209b7;
      border-radius: 12px;
      padding: 2rem;
      margin: 2rem 0;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
    }

    .pattern-line {
      padding: 0.5rem 0;
    }

    .pattern-line:hover {
      background: rgba(114, 9, 183, 0.05);
      border-radius: 4px;
    }

    .pattern-center {
      padding: 1rem;
      margin: 1rem 0;
      background: linear-gradient(90deg, #faf5ff 0%, #fef3f2 100%);
      border-left: 4px solid #e11d48;
      border-radius: 8px;
      font-weight: 600;
      text-align: center;
    }

    .indent-1 { padding-left: 1.5rem; }
    .indent-2 { padding-left: 3rem; }

    /* Name Cards */
    .name-card {
      background: white;
      border: 1px solid #e5e7eb;
      border-radius: 12px;
      padding: 1.5rem;
      margin: 1rem 0;
    }

    .name-card:hover {
      box-shadow: 0 6px 12px rgba(0,0,0,0.1);
      border-color: #7209b7;
    }

    .name-hebrew {
      font-family: 'SBL Hebrew', 'Ezra SIL', serif;
      font-size: 1.8rem;
      color: #7209b7;
      margin-right: 1rem;
      direction: rtl;
      unicode-bidi: embed;
    }

    .name-insight {
      background: linear-gradient(135deg, #fef3f2 0%, #faf5ff 100%);
      border-left: 4px solid #e11d48;
      padding: 1.5rem;
      margin: 1rem 0;
      border-radius: 8px;
    }

    .name-insight h5 {
      color: #e11d48;
      margin-bottom: 0.75rem;
    }

    /* Summary Box with Gradient */
    .critical-summary {
      background: linear-gradient(135deg, #fef3f2 0%, #faf5ff 100%);
      border: 2px solid #e11d48;
      padding: 2rem;
      margin: 2rem 0;
      border-radius: 16px;
    }

    /* NEW: Sticky Table of Contents for Desktop */
    .table-of-contents {
      position: sticky;
      top: 100px;
      float: right;
      width: 250px;
      margin-left: 2rem;
      padding: 1rem;
      background: white;
      border: 1px solid #e5e7eb;
      border-radius: 12px;
      display: none;
    }

    @media (min-width: 1200px) {
      .table-of-contents {
        display: block;
      }
      
      .content-section {
        max-width: calc(var(--max-width-content) - 300px);
      }
    }

    .toc-title {
      font-weight: 600;
      color: #7209b7;
      margin-bottom: 1rem;
      font-size: 0.9rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .toc-link {
      display: block;
      padding: 0.5rem 0.75rem;
      color: #6b7280;
      text-decoration: none;
      font-size: 0.9rem;
      border-radius: 6px;
      margin: 0.25rem 0;
    }

    .toc-link:hover {
      background: #f8f9ff;
      color: #7209b7;
    }

    .toc-link.active {
      background: linear-gradient(135deg, #faf5ff 0%, #f0f4ff 100%);
      color: #7209b7;
      font-weight: 600;
    }

    /* NEW: Print/Save Button */
    .utility-buttons {
      position: fixed;
      top: 80px;
      right: 20px;
      display: flex;
      gap: 0.5rem;
      z-index: 100;
    }

    .utility-button {
      background: white;
      border: 1px solid #e5e7eb;
      padding: 0.5rem;
      border-radius: 8px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      width: 40px;
      height: 40px;
      opacity: 0.8;
    }

    .utility-button:hover {
      opacity: 1;
      background: #f8f9ff;
      border-color: #7209b7;
    }

    /* NEW: Progress Dots */
    .progress-dots {
      position: fixed;
      right: 20px;
      top: 50%;
      transform: translateY(-50%);
      display: none;
      flex-direction: column;
      gap: 0.75rem;
      z-index: 100;
    }

    @media (min-width: 768px) and (max-width: 1199px) {
      .progress-dots {
        display: flex;
      }
    }

    .progress-dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: #e5e7eb;
      cursor: pointer;
      position: relative;
    }

    .progress-dot.active {
      background: linear-gradient(135deg, #7209b7 0%, #e11d48 100%);
    }

    .progress-dot:hover::after {
      content: attr(data-label);
      position: absolute;
      right: 20px;
      top: 50%;
      transform: translateY(-50%);
      background: #333;
      color: white;
      padding: 0.25rem 0.5rem;
      border-radius: 4px;
      font-size: 0.75rem;
      white-space: nowrap;
    }

    /* Mobile Responsiveness */
    @media (max-width: 768px) {
      .content-section {
        padding: 5rem 1rem 2rem;
      }

      .comparison-row {
        grid-template-columns: 1fr;
        gap: 1rem;
      }

      .comparison-arrow {
        transform: rotate(90deg);
      }

      .word-chips-container {
        flex-direction: column;
      }

      .hebrew-text {
        font-size: 1.4rem;
      }

      .hebrew-main {
        font-size: 2rem;
      }

      .indent-1 { padding-left: 1rem; }
      .indent-2 { padding-left: 2rem; }

      .utility-buttons {
        display: none;
      }
    }

    /* Simple scroll-to-top button */
    .scroll-top {
      position: fixed;
      bottom: 2rem;
      right: 2rem;
      background: linear-gradient(135deg, #7209b7 0%, #e11d48 100%);
      color: white;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      text-decoration: none;
      box-shadow: 0 4px 15px rgba(114, 9, 183, 0.3);
      z-index: 999;
      border: none;
      cursor: pointer;
      font-size: 1.5rem;
      opacity: 0;
    }

    .scroll-top.visible {
      opacity: 1;
    }

    .scroll-top:hover {
      box-shadow: 0 6px 20px rgba(114, 9, 183, 0.4);
    }

    /* Reading Progress Bar */
    .reading-progress {
      position: fixed;
      top: 0;
      left: 0;
      height: 3px;
      background: linear-gradient(90deg, #7209b7, #e11d48);
      z-index: 1001;
      width: 0%;
    }
  </style>
</head>
<body>

  <!-- Skip Link -->
  <a href="#main-content" class="skip-link">Skip to main content</a>

  <!-- Reading Progress Bar -->
  <div class="reading-progress"></div>

  <!-- Utility Buttons -->
  <div class="utility-buttons">
    <button class="utility-button" onclick="window.print()" aria-label="Print page">
      ð¨ï¸
    </button>
    <button class="utility-button" onclick="shareePage()" aria-label="Share page">
      ð¤
    </button>
  </div>

  <!-- Progress Dots for Tablet -->
  <div class="progress-dots" id="progressDots"></div>

  <!-- Table of Contents for Desktop -->
  <aside class="table-of-contents">
    <div class="toc-title">On This Page</div>
    <a href="#word-chips-quick" class="toc-link">Quick Reference</a>
    <a href="#abraham-parallel" class="toc-link">Abraham Parallel</a>
    <a href="#key-words" class="toc-link">Key Hebrew Words</a>
    <a href="#shuv" class="toc-link">Return Pattern</a>
    <a href="#hesed" class="toc-link">Covenant Love</a>
    <a href="#davaq-section" class="toc-link">Clinging</a>
    <a href="#wings" class="toc-link">Wings Motif</a>
    <a href="#goel" class="toc-link">Redemption</a>
    <a href="#names" class="toc-link">Name Meanings</a>
  </aside>

  <main id="main-content" class="content-section">
    
    <!-- Breadcrumbs -->
    <div class="breadcrumbs">
      <a href="/">Home</a> âº 
      <a href="/studies/">Studies</a> âº 
      <a href="/studies/tanakh/">Tanakh</a> âº 
      <a href="/studies/tanakh/ketuvim/">Ketuvim</a> âº 
      <a href="/studies/tanakh/ketuvim/ruth/">Ruth</a> âº 
      Hebrew Wordplay & Motifs
    </div>

    <h2 class="section-title">
      <span class="section-icon">ð</span>
      Hebrew Wordplay & Motifs
      <span class="hebrew-large">×¨×Ö¼×ª</span>
    </h2>

    <!-- Visual Word Chips Section with Tooltips -->
    <div class="theology-card" id="word-chips-quick">
      <h3>Key Hebrew Terms - Visual Quick Reference</h3>
      <p style="text-align: center; color: #6b7280; margin-bottom: 2rem;">
        <em>Hover for meaning â¢ Click to jump to detailed analysis</em>
      </p>
      
      <div class="word-chips-container">
        <!-- Hesed Chip -->
        <a href="#hesed" class="word-chip-link">
          <div class="word-chip">
            <span class="hebrew-word">×Ö¶×¡Ö¶×</span>
            <span class="transliteration">á¸¥esed</span>
            <div class="tooltip">Loyal love, covenant faithfulness</div>
          </div>
        </a>
        
        <!-- Goel Chip -->
        <a href="#goel" class="word-chip-link">
          <div class="word-chip">
            <span class="hebrew-word">×Ö¹Ö¼×Öµ×</span>
            <span class="transliteration">go'el</span>
            <div class="tooltip">Kinsman-redeemer</div>
          </div>
        </a>
        
        <!-- Shuv Chip -->
        <a href="#shuv" class="word-chip-link">
          <div class="word-chip">
            <span class="hebrew-word">×©××Ö¼×</span>
            <span class="transliteration">shuv</span>
            <div class="tooltip">Return, repent (12x in ch.1)</div>
          </div>
        </a>

        <!-- Davaq Chip -->
        <a href="#davaq-section" class="word-chip-link">
          <div class="word-chip">
            <span class="hebrew-word">×Ö¸Ö¼×Ö·×§</span>
            <span class="transliteration">davaq</span>
            <div class="tooltip">Cling, cleave (Gen 2:24 echo)</div>
          </div>
        </a>
        
        <!-- Kanaph Chip -->
        <a href="#wings" class="word-chip-link">
          <div class="word-chip">
            <span class="hebrew-word">×Ö¸Ö¼× Ö¸×£</span>
            <span class="transliteration">kanaph</span>
            <div class="tooltip">Wing, garment edge</div>
          </div>
        </a>
      </div>
    </div>

    <!-- Abraham Parallel -->
    <div class="word-pattern-card" id="abraham-parallel">
      <h3>Ruth as Female Abraham: The ××Ö¹×Ö¶×Ö¶×ª (Moledet) Parallel
        <span class="critical-badge">Critical</span>
      </h3>
      
      <div class="hebrew-display">
        <div class="hebrew-main">××Ö¹×Ö¶×Ö¶×ª</div>
        <div class="transliteration">moledet</div>
        <div class="translation">"birthplace, homeland, place of origin"</div>
      </div>

      <p>One of the most profound wordplays in Ruth occurs when Boaz recognizes Ruth's Abrahamic faith by using nearly identical language to describe her journey.</p>

      <div class="hebrew-comparison">
        <h4>Direct Hebrew Comparison: God's Call vs. Boaz's Recognition</h4>
        
        <div class="comparison-row">
          <div class="comparison-item">
            <strong>Genesis 12:1 â God to Abraham</strong>
            <div class="hebrew-text">
              ×Ö¶×Ö°Ö¾×Ö°×Ö¸ ×Öµ×Ö·×¨Ö°×¦Ö°×Ö¸<br>
              <span class="hebrew-highlight">×Ö¼×Ö´×Ö¼×Ö¹×Ö·×Ö°×ªÖ°Ö¼×Ö¸</span><br>
              ×Ö¼×Ö´×ÖµÖ¼××ª ×Ö¸×Ö´××Ö¸
            </div>
            <small><em>"Go from your land,<br>
            <strong>and from your birthplace,</strong><br>
            and from your father's house"</em></small>
          </div>
          
          <div class="comparison-arrow">â</div>
          
          <div class="comparison-item">
            <strong>Ruth 2:11 â Boaz to Ruth</strong>
            <div class="hebrew-text">
              ×Ö·×ªÖ·Ö¼×¢Ö·×Ö°×Ö´× ×Ö¸×Ö´××Ö° ×Ö°×Ö´×ÖµÖ¼×Ö°<br>
              <span class="hebrew-highlight">×Ö°×Ö¶×¨Ö¶×¥ ××Ö¹×Ö·×Ö°×ªÖµÖ¼×Ö°</span><br>
              ×Ö·×ªÖµÖ¼×Ö°×Ö´× ×Ö¶×Ö¾×¢Ö·×
            </div>
            <small><em>"And you left your father and mother,<br>
            <strong>and the land of your birthplace,</strong><br>
            and went to a people"</em></small>
          </div>
        </div>
      </div>

      <div class="key-insight">
        <strong>Literary Brilliance:</strong> 
        The narrator doesn't make this connection explicitlyâinstead, it's placed in Boaz's mouth, suggesting that true spiritual leaders recognize faith patterns across ethnic boundaries. When Boaz sees Ruth, he doesn't see "Moabite woman" but "female Abraham."
      </div>
    </div>

    <!-- All other sections remain the same... -->

    <!-- Continue Study Links - WITH MISSING STUDY KIT ADDED -->
    <div class="theology-card">
      <h3>Continue Your Ruth Study</h3>
      
      <div class="cta-grid">
        <a href="/studies/tanakh/ketuvim/ruth/ruth-overview.html" class="cta-button">
          ð Overview
        </a>
        <a href="/studies/tanakh/ketuvim/ruth/ruth-literary.html" class="cta-button">
          ð Literary Design
        </a>
        <a href="/studies/tanakh/ketuvim/ruth/ruth-wordplay.html" class="cta-button">
          âï¸ Hebrew Wordplay
        </a>
        <a href="/studies/tanakh/ketuvim/ruth/ruth-intertext.html" class="cta-button">
          ð Biblical Connections
        </a>
        <a href="/studies/tanakh/ketuvim/ruth/ruth-theology.html" class="cta-button">
          âª Theological Themes
        </a>
        <a href="/studies/tanakh/ketuvim/ruth/ruth-study-kit.html" class="cta-button">
          ð Complete Study Kit
        </a>
      </div>
    </div>

    <!-- Scroll to top button -->
    <button class="scroll-top" id="scrollTop" aria-label="Back to top">â</button>

  </main>

  <!-- Navigation Component Import -->
  <script type="module">
    import('/assets/js/nav-component.js')
      .then(module => {
        const navigation = new module.default({
          currentPage: 'studies/tanakh/ketuvim/ruth',
          hubType: 'tanakh'
        });
      })
      .catch(err => {
        console.warn('Navigation component not available', err);
        // Fallback navigation
        document.body.insertAdjacentHTML('afterbegin', `
          <nav>
            <div class="nav-container">
              <a href="/" class="logo">
                <span class="logo-text">Project Context</span>
              </a>
              <div class="nav-links">
                <a href="/">Home</a>
                <a href="/studies/">Studies</a>
                <a href="/resources/">Resources</a>
                <a href="/about/">About</a>
              </div>
            </div>
          </nav>
        `);
      });
  </script>

  <!-- Enhanced JavaScript with safe UX features -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      
      // 1. Reading progress bar
      function updateProgress() {
        const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
        const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
        const scrolled = (winScroll / height) * 100;
        const progressBar = document.querySelector('.reading-progress');
        if (progressBar) {
          progressBar.style.width = scrolled + '%';
        }
      }
      
      // 2. Scroll to top button visibility
      function updateScrollButton() {
        const scrollTop = document.getElementById('scrollTop');
        if (window.scrollY > 500) {
          scrollTop.classList.add('visible');
        } else {
          scrollTop.classList.remove('visible');
        }
      }
      
      // 3. Progress dots for tablet
      function createProgressDots() {
        const sections = document.querySelectorAll('.theology-card[id], .word-pattern-card[id]');
        const dotsContainer = document.getElementById('progressDots');
        
        if (!dotsContainer || sections.length === 0) return;
        
        sections.forEach((section, index) => {
          const dot = document.createElement('div');
          dot.className = 'progress-dot';
          dot.setAttribute('data-label', section.querySelector('h3')?.textContent.substring(0, 20) || 'Section');
          dot.onclick = () => {
            section.scrollIntoView({ behavior: 'smooth', block: 'start' });
          };
          dotsContainer.appendChild(dot);
        });
      }
      
      // 4. Update active sections (TOC and dots)
      function updateActiveSection() {
        const sections = document.querySelectorAll('.theology-card[id], .word-pattern-card[id]');
        const tocLinks = document.querySelectorAll('.toc-link');
        const dots = document.querySelectorAll('.progress-dot');
        
        let currentSection = '';
        
        sections.forEach((section, index) => {
          const rect = section.getBoundingClientRect();
          if (rect.top <= 150 && rect.bottom >= 150) {
            currentSection = section.id;
            
            // Update TOC
            tocLinks.forEach(link => {
              link.classList.remove('active');
              if (link.getAttribute('href') === `#${currentSection}`) {
                link.classList.add('active');
              }
            });
            
            // Update dots
            dots.forEach((dot, dotIndex) => {
              dot.classList.toggle('active', dotIndex === index);
            });
          }
        });
      }
      
      // 5. Share functionality
      window.shareePage = function() {
        if (navigator.share) {
          navigator.share({
            title: document.title,
            text: 'Hebrew Wordplay & Motifs in Ruth',
            url: window.location.href
          });
        } else {
          // Fallback: copy URL to clipboard
          navigator.clipboard.writeText(window.location.href)
            .then(() => alert('Link copied to clipboard!'))
            .catch(() => alert('Share not available'));
        }
      };
      
      // 6. Smooth scroll for anchor links
      document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
          e.preventDefault();
          const target = document.querySelector(this.getAttribute('href'));
          if (target) {
            const offset = 80;
            const targetPosition = target.getBoundingClientRect().top + window.scrollY - offset;
            window.scrollTo({
              top: targetPosition,
              behavior: 'smooth'
            });
          }
        });
      });
      
      // 7. Throttled scroll handler
      let scrollTimer;
      window.addEventListener('scroll', () => {
        if (scrollTimer) {
          cancelAnimationFrame(scrollTimer);
        }
        scrollTimer = requestAnimationFrame(() => {
          updateProgress();
          updateScrollButton();
          updateActiveSection();
        });
      });
      
      // Initialize
      createProgressDots();
      updateProgress();
      updateScrollButton();
      updateActiveSection();
    });
  </script>

  <!-- Import character-page.js for additional functionality -->
  <script src="/assets/js/character-page.js" defer></script>

</body>
</html>